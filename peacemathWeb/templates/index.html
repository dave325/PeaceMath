<!DOCTYPE html>
<html>

<head>
	<title>Peace Math</title>


	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
		integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet"
		type='text/css'>



	{% load staticfiles %}



	<style>
		#annot {
			visibility: hidden;
			position: absolute;
			z-index: 5000;
			border:2px solid  black;
			background-color: white;
			padding: 5px;
		}

		#annot #annotTitle{
		
			font-size: 1.8em;
			text-decoration: underline;

		}

		#annot #annotDescr{
			font-size: 1.0em;
		}



		#loader {
			border: 16px solid #f3f3f3;
			/* Light grey */
			border-top: 16px solid #3498db;
			/* Blue */
			border-radius: 50%;
			width: 120px;
			height: 120px;
			animation: spin 2s linear infinite;
			display: block;

			margin-left: auto;
			margin-right: auto;
			margin-top: 200px;
			display: none;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}

		#sidebar {
			/*background: red;*/
			position: fixed;
			top: 0;
			height: 100vh;
			overflow-y: scroll;
			overflow-x: hidden;
			width: 500px;
			/* 0 width - change this with JavaScript */
			z-index: 1;

			text-align: cener;
			background-color: lightgray;

		}

		#openMenu {
			text-align: center;
			position: fixed;
			top: 10px;
			left: 10px;

		}


		html {
			max-height: 100vh !important;
		}

		/*
		   by default have menu hidden (pushed left)
		*/
		.menu-left-hide {
			left: -700px;
			opacity: 0.5;
		}

		/*
		  on toggle, push the menu to the right and open it
		*/
		.menu-left-open {
			left: 0;
			opacity: 1;
		}


		#main {
			overflow-y: hidden;

		}

		#title {
			color: #5bc0de;
		}


		.main-push-right {
			left: 700px !important;
		}

		#b {
			width: 800px !important;
			margin-left: auto;
			margin-right: auto;
			margin-top: -100px;
			display: none;

		}

		.menu-left-hide,
		.menu-left-open {
			-webkit-transition: 200ms ease-in-out;
			transition: 200ms ease-in-out;
		}

		.tab {
			display: none;
		}

		.tab p {
			font-size: 1.5em;
			text-align: center;
		}

		#toggleBar {
			background-color: lightgray;
			min-height: 100vh;
			overflow-y: hidden;
			position: absolute;
			top: 0;
			width: 50px;
		}

		.rangeText {

			font-size: 1.2em;

		}

		.sidebarLabel{
			font-weight: 650;
			margin-top: 5px;
		}

	</style>


</head>

<body>

	<div id="annot">
		<p id="annotTitle"></p>
		<p id="annotDescr"></p>
	</div>
	<h1 id="title" class="mb-5 text-center">PeaceMath Model</h1>
	<div id="loader"></div>


	<div class="container" id="questions">



		<div class="row">
			<div class="col-2">

			</div>
			<div class="col-8">
				<form id="regForm">
					<div id="questionContainer">

						<div class="tab col-12">
							<h2 class="text-center">How do different conditions and processes in your society interact
								to
								influence peace?</h2>
							</br>
							<p>
								This interactive model can be used to visualize how different factors interact to
								produce
								different
								levels of peacefulness of entire societies.
								To begin, please respond to a series of questions about the society you are interested
								in.
								Then
								click “Calculate”
							</p>
						</div>

						<div class="tab col-12">
							<h2 class="text-center">How would you describe your society?</h2>
							</br>
							<p>
								Please respond to these questions with reference to the specific intergroup relations
								you
								see as
								most influential to the state of peace in your society.
						</div>




						<div class="tab col-12">
							<p>
								To what degree do you believe Positive Intergroup Reciprocity, or positive
								interactions between members of different identity groups, is prevalent in your society?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe Negative Intergroup Reciprocity, or negative
								interactions between members of different identity groups, is prevalent in your society?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>



						<div class="tab col-12">
							<p>
								To what degree do you believe Positive Norms, or those which promote positive
								interactions between members of different identity groups, are prevalent in your
								society?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe Preventative Norms, or those which prevent negative
								interactions between members of different identity groups, are prevalent in your
								society?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe Positive Intergroup History, or positive accounts of
								past intergroup relations, are prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe Negative Intergroup History, or negative accounts of
								past intergroup relations, are prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree are Positive Intergroup Goals, or positive expectations regarding
								future intergroup relations, prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>



						<div class="tab col-12">
							<p>
								To what degree are Negative Intergroup Goals, or negative expectations regarding
								future intergroup relations, prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you see Symbols of Peacefulness (e.g. ceremonies, monuments,
								parks, songs, artwork celebrating peacefulness) prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe Cross-cutting Structures, or groups, teams, or
								organizations that bring members of different identity groups together in cooperation,
								prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe Good Governance serves to unite groups across
								identity differences in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe ready access to formal and informal mechanisms for
								Constructive Conflict Resolution are prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe fair and effective mechanisms for Justice serve to reduce
								destructive intergroup conflict in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree to you feel that sufficient levels of Safety and Security in local
								communities contribute to reducing destructive intergroup conflict in your society
								today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe Leaders and other high-status members of society model
								peaceful values and constructive conflict resolution in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe commitment to fair and Sustainable Development policies
								and practices are prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe people in your society hold Values and Beliefs that
								prioritize
								respecting the universe, humanity, family and friends, more than one’s own personal
								goals,
								wealth, or power today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe early access to Education that emphasizes tolerance,
								multiculturalism and constructive conflict resolution prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe a Shared Overarching Identity (e.g. a strong uniting
								national, geographic or cultural identity) exists across groups in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe a clear Vision and understanding of what it takes to live
								in
								peace are prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe an Equitable Distribution of Resources and
								opportunities are prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe Information Flows freely and openly for members of all
								groups in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe Basic Needs such as food, water, and shelter are
								sufficiently
								satisfied across all identity groups in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe people in your society hold Non-violent Values and
								Attitudes today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

						<div class="tab col-12">
							<p>
								To what degree do you believe the Rule of Law functions sufficiently to guarantee safety
								and
								security for members of all groups prevalent in your society today?
							</p>

							<div class="col-12">
								<input type="range" class="w-100 rangeInput" name="rangeInput" step="1" min="1" max="4">
								<label class="w-100 text-center rangeText" />
							</div>
						</div>

					</div>

					<br>

					<div class="text-center">
						<button class="btn btn-outline-secondary" type="button" id="prevBtn"
							onclick="nextPrev(-1)">Previous</button>
						<button class="btn btn-outline-primary" type="button" id="nextBtn"
							onclick="nextPrev(1)">Next</button>
					</div>



				</form>
			</div>

			<div class="col-2">

			</div>
		</div>


	</div>






	<div id="sidebar" class="menu-left-hide text-center pt-4">



		<div class="row px-5">


			<div class="col-6">


				<div class="row">
					<div class="col-6">
						<button name="enter" class="btn btn-light btn-outline-dark" id="btn_enter">CALCULATE</button>

					</div>
					<div class="col-6">
						<!--
						<button name="calculate" class="btn btn-light btn-outline-dark"
							id="btn_calculate">CALCULATE</button>
						-->
					</div>

				</div>



			</div>

			<div class="col-3"></div>

			<div class="col-3">
				<button class="btn btn-large ml-5" id="closeMenu">
					<i class="fas fa-window-close fa-2x"></i>
				</button>
			</div>


		</div>


		<div class="row px-5">

			<div class="col-12">


				{% csrf_token %}


				{% for label in inputFields %}



				<label class="sidebarLabel" for={{label}}>{{label}}</label>

				<div class="row">

					<div class="PositiveNegative btn-group col-3" role="group">
						<button type="button" class=" btn active btn-outline-primary">
							<i class="fa fas fa-plus"></i>
						</button>
						<button type="button" class=" btn  btn-outline-danger">
							<i class="fa fas fa-minus"></i>
						</button>
					</div>


					<select id={{label}} class="col-9 b_values">
						<option value="0">None</option>
						<option value="0.75" selected="selected">Small</option>
						<option value="2">Medium</option>
						<option value="6">Strong</option>
					</select>


					<!--
					<input class="form-control b_values col-12" type="number" placeholder="1.0" min="0" max="100" step="0.1"
						 >
					-->



				</div>


				{% endfor %}


				<hr>



			</div>




		</div>
	</div>



	<button class="btn btn-large btn-primary" id="openMenu">
		<i class="fas fa-bars fa-2x"></i>
	</button>





	<div id="main">

		<div id="b">
			{{box_graph | safe}}
		</div>

	</div>




	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
		integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
		crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
		integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
		crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
		integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
		crossorigin="anonymous"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script id="lzutf8" src="https://cdn.jsdelivr.net/npm/lzutf8/build/production/lzutf8.js"></script>

</body>

<!-- ASYNC SCRIPT LOADERS -->
<script type="text/javascript" async src="{% static 'index.js' %}"></script>

<script>

	// Multi-Step Form
	var currentTab = 0; // Current tab is set to be the first tab (0)
	showTab(currentTab); // Display the crurrent tab

	function showTab(n) {
		// This function will display the specified tab of the form...
		var x = document.getElementsByClassName("tab");
		x[n].style.display = "block";
		//... and fix the Previous/Next buttons:
		if (n == 0) {
			document.getElementById("prevBtn").style.display = "none";
		} else {
			document.getElementById("prevBtn").style.display = "inline";
		}
		if (n == (x.length - 1)) {
			document.getElementById("nextBtn").innerHTML = "Calculate";
		} else {
			document.getElementById("nextBtn").innerHTML = "Next";
		}

	}

	function nextPrev(n) {
		// This function will figure out which tab to display
		var x = document.getElementsByClassName("tab");
		// Exit the function if any field in the current tab is invalid:
		if (n == 1 && !validateForm()) return false;
		// Hide the current tab:
		x[currentTab].style.display = "none";
		// Increase or decrease the current tab by 1:
		currentTab = currentTab + n;
		// if you have reached the end of the form...
		if (currentTab >= x.length) {
			// ... the form gets submitted:
			document.getElementById("regForm").submit();
			return false;
		}
		// Otherwise, display the correct tab:
		showTab(currentTab);
	}

	function validateForm() {
		return true;
	}


</script>

<script type="text/javascript">

	$(function () {

		$('.PositiveNegative').each(function (index) {


			let group = $(this);

			let children = group.children()
			let positiveButton = $(children[0])
			let negativeButton = $(children[1])

			let isPositive = true;

			negativeButton.click(() => {
				if (isPositive) {
					positiveButton.removeClass("active")
					negativeButton.addClass("active")
					isPositive = false;
				}
			})

			positiveButton.click(() => {
				if (!isPositive) {
					positiveButton.addClass("active")
					negativeButton.removeClass("active")
					isPositive = true
				}
			})


		});

		var rangeValues =
		{
			"1": "Not at all",
			"2": "Very little",
			"3": "Somewhat",
			"4": "To a great extent"
		};

		$('.rangeText').text(rangeValues[$('.rangeInput').val()]);

		var all = $(".rangeInput").each(function (index) {

			var input = this;
			input.addEventListener('change', function () {

				$($('.rangeText').get(index)).text(rangeValues[$(this).val()]);

			});
		});

		//this.text(rangeValues[$(this).val()]);

	});


	function hideMenu() {
		$('#sidebar').removeClass('menu-left-open');
		sidebarOpen = false;
	};

	function showMenu() {
		$('#sidebar').addClass('menu-left-open');
		sidebarOpen = true;
	};

	var sidebarOpen = false;

	$('#openMenu').click(function () {

		showMenu();

	});
	$('#closeMenu').click(function () {

		hideMenu();

	});



	//console.log({{dataValues | safe}})
	window.sessionStorage.setItem("key", "{{session_key}}")
	console.log("Adding text listeners")

	let text = document.getElementsByClassName("mpld3-text");
	for (let j = 0; j < text.length; j++) {
		console.log(text[j])
		text[j].addEventListener('click', () => {
			data = JSON.stringify({ key: window.sessionStorage.getItem("key"), val: j })
			fetch('/physics/btn_click/', {
				method: 'post', headers: {
					'Accept': 'application/json',
					'Content-Type': 'application/json'
				}, body: data
			}).then((res) => {
				res.json().then(

					(i) => {
						console.log(i)
					}
				)
			})
		});
	}








</script>




</html>